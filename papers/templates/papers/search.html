{% extends "dissemin/details.html" %}

{% load staticfiles %}
{% load bootstrap_pagination %}

{% block headTitle %}
{{ search_description }}
{% endblock %}

{% block bodyTitle %}
{{ search_description }}
{% endblock %}

{% block details %}
{% if researcher %}
    <span class="detailsTitle">{{ researcher }}</span>
    <div class="detailsContent">
        <p><a href="{% url 'department' researcher.department.id %}">{{ researcher.department }}</a></p>
    </div>
{% endif %}
{% if journal %}
    <span class="detailsTitle">{{ journal }}</span>
    <div class="detailsContent">
        <p>Published by <a href="{% url 'publisher' journal.publisher.id %}">{{ journal.publisher }}</a></p>
        {% if journal.issn %}
        <p>ISSN: {{ journal.issn }}</p>
        {% endif %}
    </div>
{% endif %}

<span class="detailsTitle">Refine search</span>
<div class="detailsContent">
<p>{{ nb_results }} papers found</p>
<span class="criterion">By publisher policy:</span>
{% for st in oa_status_choices %}
<div class="{% if st.0 == status %}selectedCriterion{% else %}unselectedCriterion{% endif %}">
    <div class="pubLogo"><div class="pubLogoPic-{{ st.0 }}"><a href="{% url 'search' %}?{{ st.2.urlencode }}" class="filldiv"></a></div></div>
    <div class="criterionItem"><a href="{% url 'search' %}?{{ st.2.urlencode }}">{{ st.1 }}</a>
        {% if st.0 == status %}
        <div class="criterionCross"><a href="{% url 'search' %}?{{ st.2.urlencode }}">x</a></div>
        {% endif %}
    </div>
</div>
{% endfor %}
<span class="criterion">By full text availability:</span>
{% for st in pdf_status_choices %}
<div class="{% if st.0 == pdf %}selectedCriterion{% else %}unselectedCriterion{% endif %}">
     <div class="pubLogo"><div class="pubLogoPic-PDF-{{ st.0 }}"><a href="{% url 'search' %}?{{ st.2.urlencode }}" class="filldiv"></a></div></div>
    <div class="criterionItem"><a href="{% url 'search' %}?{{ st.2.urlencode }}">{{ st.1 }}</a>
        {% if st.0 == pdf %}
        <div class="criterionCross"><a href="{% url 'search' %}?{{ st.2.urlencode }}">x</a></div>
        {% endif %}
    </div>
</div>
{% endfor %}
</div>
{% endblock %}

{% block lists %}
<div class="searchPages">{% bootstrap_paginate search_results range=10 %}</div>
 {% for paper in search_results %}
 {% ifchanged paper.year %}
 {% if not forloop.first %}</ul></div>{% endif %}
    <div class="ulContainer">
    <div class="listYear">{{ paper.year }}</div><ul>
 {% endifchanged %}
    <li>
        {% include "papers/publiListItem.html" with paper=paper %}
</li>    
        {% if forloop.last %}</ul></div>{% endif %}
 {% empty %}
 <p>No production found.</p>
 {% endfor %}
 {% if search_results.paginator.num_pages > 1 %}
 <div class="searchPages">{% bootstrap_paginate search_results range=10 %}</div>
 {% endif %}
{% endblock %}
